{"ast":null,"code":"'use strict';\n\n/*!\n * ignore\n */\nmodule.exports = applyQueryMiddleware;\nconst validOps = require('./validOps');\n\n/*!\n * ignore\n */\n\napplyQueryMiddleware.middlewareFunctions = validOps.concat(['validate']);\n\n/**\n * Apply query middleware\n *\n * @param {Query} Query constructor\n * @param {Model} model\n * @api private\n */\n\nfunction applyQueryMiddleware(Query, model) {\n  const queryMiddleware = model.schema.s.hooks.filter(hook => {\n    const contexts = _getContexts(hook);\n    if (hook.name === 'validate') {\n      return !!contexts.query;\n    }\n    if (hook.name === 'deleteOne' || hook.name === 'updateOne') {\n      return !!contexts.query || Object.keys(contexts).length === 0;\n    }\n    if (hook.query != null || hook.document != null) {\n      return !!hook.query;\n    }\n    return true;\n  });\n  Query.prototype._queryMiddleware = queryMiddleware;\n}\nfunction _getContexts(hook) {\n  const ret = {};\n  if (hook.hasOwnProperty('query')) {\n    ret.query = hook.query;\n  }\n  if (hook.hasOwnProperty('document')) {\n    ret.document = hook.document;\n  }\n  return ret;\n}","map":{"version":3,"names":["module","exports","applyQueryMiddleware","validOps","require","middlewareFunctions","concat","Query","model","queryMiddleware","schema","s","hooks","filter","hook","contexts","_getContexts","name","query","Object","keys","length","document","prototype","_queryMiddleware","ret","hasOwnProperty"],"sources":["C:/Users/Lenovo/node_modules/mongoose/lib/helpers/query/applyQueryMiddleware.js"],"sourcesContent":["'use strict';\n\n/*!\n * ignore\n */\n\nmodule.exports = applyQueryMiddleware;\n\nconst validOps = require('./validOps');\n\n/*!\n * ignore\n */\n\napplyQueryMiddleware.middlewareFunctions = validOps.concat([\n  'validate'\n]);\n\n/**\n * Apply query middleware\n *\n * @param {Query} Query constructor\n * @param {Model} model\n * @api private\n */\n\nfunction applyQueryMiddleware(Query, model) {\n  const queryMiddleware = model.schema.s.hooks.filter(hook => {\n    const contexts = _getContexts(hook);\n    if (hook.name === 'validate') {\n      return !!contexts.query;\n    }\n    if (hook.name === 'deleteOne' || hook.name === 'updateOne') {\n      return !!contexts.query || Object.keys(contexts).length === 0;\n    }\n    if (hook.query != null || hook.document != null) {\n      return !!hook.query;\n    }\n    return true;\n  });\n\n  Query.prototype._queryMiddleware = queryMiddleware;\n}\n\nfunction _getContexts(hook) {\n  const ret = {};\n  if (hook.hasOwnProperty('query')) {\n    ret.query = hook.query;\n  }\n  if (hook.hasOwnProperty('document')) {\n    ret.document = hook.document;\n  }\n  return ret;\n}\n"],"mappings":"AAAA,YAAY;;AAEZ;AACA;AACA;AAEAA,MAAM,CAACC,OAAO,GAAGC,oBAAoB;AAErC,MAAMC,QAAQ,GAAGC,OAAO,CAAC,YAAY,CAAC;;AAEtC;AACA;AACA;;AAEAF,oBAAoB,CAACG,mBAAmB,GAAGF,QAAQ,CAACG,MAAM,CAAC,CACzD,UAAU,CACX,CAAC;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASJ,oBAAoBA,CAACK,KAAK,EAAEC,KAAK,EAAE;EAC1C,MAAMC,eAAe,GAAGD,KAAK,CAACE,MAAM,CAACC,CAAC,CAACC,KAAK,CAACC,MAAM,CAACC,IAAI,IAAI;IAC1D,MAAMC,QAAQ,GAAGC,YAAY,CAACF,IAAI,CAAC;IACnC,IAAIA,IAAI,CAACG,IAAI,KAAK,UAAU,EAAE;MAC5B,OAAO,CAAC,CAACF,QAAQ,CAACG,KAAK;IACzB;IACA,IAAIJ,IAAI,CAACG,IAAI,KAAK,WAAW,IAAIH,IAAI,CAACG,IAAI,KAAK,WAAW,EAAE;MAC1D,OAAO,CAAC,CAACF,QAAQ,CAACG,KAAK,IAAIC,MAAM,CAACC,IAAI,CAACL,QAAQ,CAAC,CAACM,MAAM,KAAK,CAAC;IAC/D;IACA,IAAIP,IAAI,CAACI,KAAK,IAAI,IAAI,IAAIJ,IAAI,CAACQ,QAAQ,IAAI,IAAI,EAAE;MAC/C,OAAO,CAAC,CAACR,IAAI,CAACI,KAAK;IACrB;IACA,OAAO,IAAI;EACb,CAAC,CAAC;EAEFX,KAAK,CAACgB,SAAS,CAACC,gBAAgB,GAAGf,eAAe;AACpD;AAEA,SAASO,YAAYA,CAACF,IAAI,EAAE;EAC1B,MAAMW,GAAG,GAAG,CAAC,CAAC;EACd,IAAIX,IAAI,CAACY,cAAc,CAAC,OAAO,CAAC,EAAE;IAChCD,GAAG,CAACP,KAAK,GAAGJ,IAAI,CAACI,KAAK;EACxB;EACA,IAAIJ,IAAI,CAACY,cAAc,CAAC,UAAU,CAAC,EAAE;IACnCD,GAAG,CAACH,QAAQ,GAAGR,IAAI,CAACQ,QAAQ;EAC9B;EACA,OAAOG,GAAG;AACZ"},"metadata":{},"sourceType":"script","externalDependencies":[]}